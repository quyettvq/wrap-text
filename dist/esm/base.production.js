function r(r,n){var e=n.t,t=n.i,i=n.o,f=n.u,o=n.l,a=[],u=r[Symbol.iterator](),c=u.next(),s=f,l=0,p=!1,v=function(){if(!p){var r=a.length+s;if(i)for(;!c.done&&a.length<r;)e(a,c.value,t),c=u.next();else for(;!c.done&&a.length<r;){if("\r"===c.value||"\n"===c.value){p=!0;break}e(a,c.value,t),c=u.next()}s=Math.max(f-l,o)}};this.p=function(){return!!p&&("\r"===c.value&&(c=u.next()),"\n"===c.value&&(c=u.next()),l+=a.length,a.length=0,p=!1,!0)};this.v=function(r){if(r<0)return!1;for(;;){if(r<a.length-1)return!0;if(c.done||p)return r<a.length;v()}},this.h=function(r){if(r<0)return"";for(;;){if(r<a.length-1)return a[r];if(c.done||p)return r<a.length?a[r]:"";v()}},this.m=function(r,n){if(n<=0||n<=r)return[];for(;;){if(n<=a.length-1)return a.slice(r,n);if(c.done||p)return a.slice(r,n);v()}}}var n,e=document.createElement("canvas").getContext("2d"),t=Number.POSITIVE_INFINITY,i=function(r,n,e){e&&/\s/.test(n)?" "!==r[r.length-1]&&r.push(" "):r.push(n)},f=function(r,n,e){return!!/[\s-]/.test(r.h(n))||!(!e||!/\s/.test(r.h(n+1)))},o=function(r){for(var t="",i=0;i<r.length;i++){var f=r[i];t+="\t"===f?n:f}return e.measureText(t).width},a=function(r,n,e,t){for(;n.v(e+r.length)&&o(r)<t;)r.push(n.h(e+r.length));if(0===r.length)r.push(n.h(e));else for(;r.length>1&&o(r)>t;)r.length-=1},u=function(r,n,e){for(;r.length>0&&o(r.concat(n))>e;)r.length-=1;r.push(n)},c=function(r,n){void 0===n&&(n={}),"string"==typeof n.font?r._=n.font:r._="10px sans-serif",["auto","normal","none"].includes(n.fontKerning)?r.k=n.fontKerning:r.k="auto","number"==typeof n.tabSize?r.F=n.tabSize:r.F=8},s=function(r,n){var t={};c(t,n),e.font=t._,e.fontKerning=t.k;var i=new Array(t.F).fill(" ").join("");return e.measureText(r.replace(/\t/g,i))},l=function(s,l){var p={};c(p,l),function(r,n){void 0===n&&(n={}),"number"==typeof n.maxWidth?r.M=n.maxWidth:r.M=t,"number"==typeof n.maxLines?r.g=n.maxLines:r.g=t,"number"==typeof n.indent?r.S=n.indent:r.S=0,"number"==typeof n.lastIndent?r.C=n.lastIndent:r.C=0,"string"==typeof n.etc?r.L=n.etc:r.L="â€¦",["collapse","preserve"].includes(n.newlines)?r.A=n.newlines:r.A="collapse",["collapse","trim","preserve"].includes(n.inlineSpaces)?r.N=n.inlineSpaces:r.N="collapse"}(p,l),e.font=p._,e.fontKerning=p.k,n=new Array(p.F).fill(" ").join("");var v=function(n,e){var i=e.t,f=e.O,o=e.j,a=e.B,u=e.T,c=e.M,s=e.g,l=e.S,p=e.C,v=e.L,h=e.A,b=e.N;if(s<=0)return[];for(var m="collapse"===b||"trim"===b,y=0,_=0,k=function(r){return 0===_?Math.ceil(r/u):Math.ceil(r/(y/_))},d=[],F=new r(n,{t:i,i:"collapse"===b,o:"collapse"===h,u:s===t?t:Math.max(1,Math.floor(1.2*s*k(c))),l:Math.max(1,2*k(c))}),M=!1,g=d.length,w=0;;){var S=F.h(w);if(m)for(;/\s/.test(S);)w++,S=F.h(w);if(""===S){if(g===d.length){if(d.length===s){M=!0;break}d.push([])}if(F.p()){w=0,g=d.length;continue}break}if(d.length===s){M=!0;break}var C=0===d.length?c-l:d.length===s-1?c-p:c,L=F.m(w,w+k(C)+1);if(o(L,F,w,C),y+=C,_+=L.length,F.v(w+L.length)){for(var x=-1,z=L.length-1;z>=0;z--)if(f(F,w+z,m)){x=z;break}x>-1&&x<L.length-1&&L.splice(x+1)}if(w+=L.length,m)for(;L.length>0&&/\s/.test(L[L.length-1]);)L.length-=1;d.push(L)}return M&&a(d[d.length-1],v,c-p),d}(s,Object.assign(p,{t:i,O:f,j:a,B:u,T:o(["a"])}));return{lines:v,font:e.font}};export{s as measureText,l as wrapText};
