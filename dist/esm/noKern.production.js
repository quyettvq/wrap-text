function r(r,n){var e=n.t,t=n.i,i=n.o,f=n.u,o=n.l,a=[],u=r[Symbol.iterator](),c=u.next(),s=f,l=0,p=!1,v=function(){if(!p){var r=a.length+s;if(i)for(;!c.done&&a.length<r;)e(a,c.value,t),c=u.next();else for(;!c.done&&a.length<r;){if("\r"===c.value||"\n"===c.value){p=!0;break}e(a,c.value,t),c=u.next()}s=Math.max(f-l,o)}};this.p=function(){return!!p&&("\r"===c.value&&(c=u.next()),"\n"===c.value&&(c=u.next()),l+=a.length,a.length=0,p=!1,!0)};this.v=function(r){if(r<0)return!1;for(;;){if(r<a.length-1)return!0;if(c.done||p)return r<a.length;v()}},this.h=function(r){if(r<0)return"";for(;;){if(r<a.length-1)return a[r];if(c.done||p)return r<a.length?a[r]:"";v()}},this.m=function(r,n){if(n<=0||n<=r)return[];for(;;){if(n<=a.length-1)return a.slice(r,n);if(c.done||p)return a.slice(r,n);v()}}}var n=document.createElement("canvas").getContext("2d"),e=Number.POSITIVE_INFINITY,t=function(r,n,e){e&&/\s/.test(n)?" "!==r[r.length-1]&&r.push(" "):r.push(n)},i=function(r,n,e){return!!/[\s-]/.test(r.h(n))||!(!e||!/\s/.test(r.h(n+1)))},f=function(r,n){void 0===n&&(n={}),"string"==typeof n.font?r._=n.font:r._="10px sans-serif",["auto","normal","none"].includes(n.fontKerning)?r.k=n.fontKerning:r.k="auto","number"==typeof n.tabSize?r.F=n.tabSize:r.F=8},o=function(r,e){var t={};f(t,e),n.font=t._,n.fontKerning=t.k;var i=new Array(t.F).fill(" ").join("");return n.measureText(r.replace(/\t/g,i))},a=function(o,a){var u={};f(u,a),function(r,n){void 0===n&&(n={}),"number"==typeof n.maxWidth?r.M=n.maxWidth:r.M=e,"number"==typeof n.maxLines?r.g=n.maxLines:r.g=e,"number"==typeof n.indent?r.S=n.indent:r.S=0,"number"==typeof n.lastIndent?r.C=n.lastIndent:r.C=0,"string"==typeof n.etc?r.L=n.etc:r.L="â€¦",["collapse","preserve"].includes(n.newlines)?r.O=n.newlines:r.O="collapse",["collapse","trim","preserve"].includes(n.inlineSpaces)?r.j=n.inlineSpaces:r.j="collapse"}(u,a),n.font=u._;var c=Object.create(null),s=function(r){var e=c[r];return void 0===e&&(e="\t"===r?n.measureText(new Array(u.F).fill(" ").join("")).width:n.measureText(r).width,c[r]=e),e},l=function(r){for(var n=0,e=r.length-1;e>=0;e--)n+=s(r[e]);return n},p=function(n,t){var i=t.t,f=t.A,o=t.N,a=t.B,u=t.T,c=t.M,s=t.g,l=t.S,p=t.C,v=t.L,h=t.O,b=t.j;if(s<=0)return[];for(var m="collapse"===b||"trim"===b,y=0,_=0,d=function(r){return 0===_?Math.ceil(r/u):Math.ceil(r/(y/_))},k=[],F=new r(n,{t:i,i:"collapse"===b,o:"collapse"===h,u:s===e?e:Math.max(1,Math.floor(1.2*s*d(c))),l:Math.max(1,2*d(c))}),M=!1,g=k.length,w=0;;){var S=F.h(w);if(m)for(;/\s/.test(S);)w++,S=F.h(w);if(""===S){if(g===k.length){if(k.length===s){M=!0;break}k.push([])}if(F.p()){w=0,g=k.length;continue}break}if(k.length===s){M=!0;break}var C=0===k.length?c-l:k.length===s-1?c-p:c,L=F.m(w,w+d(C)+1);if(o(L,F,w,C),y+=C,_+=L.length,F.v(w+L.length)){for(var O=-1,j=L.length-1;j>=0;j--)if(f(F,w+j,m)){O=j;break}O>-1&&O<L.length-1&&L.splice(O+1)}if(w+=L.length,m)for(;L.length>0&&/\s/.test(L[L.length-1]);)L.length-=1;k.push(L)}return M&&a(k[k.length-1],v,c-p),k}(o,Object.assign(u,{t:t,A:i,N:function(r,n,e,t){for(var i=l(r),f="";i<t&&""!==(f=n.h(e+r.length));)r.push(f),i+=s(f);if(0===r.length)r.push(n.h(e));else for(;i>t&&r.length>1;){var o=r.pop();i-=s(o)}},B:function(r,n,e){for(var t=s(n),i=l(r);i+t>e;)i-=s(r.pop());r.push(n)},T:s("a")}));return{lines:p,font:n.font}};export{o as measureText,a as wrapText};
